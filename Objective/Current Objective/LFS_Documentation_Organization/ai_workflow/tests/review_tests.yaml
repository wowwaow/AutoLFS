# Review Pipeline Tests
version: '1.0'

# Completeness Tests
test_completeness:
  required_sections:
    test_complete_document:
      input: "test_fixtures.yaml#basic_package"
      expected: pass
    test_missing_sections:
      input: "test_fixtures.yaml#invalid_package"
      expected: fail
      missing_sections:
        - "A1_basic_info"
        - "B8_required_packages"

  section_content:
    test_valid_content:
      input:
        section: "A1_basic_info"
        content: |
          Package Name: test-package
          Version: 1.0.0
          Description: A test package
      expected: pass
    test_insufficient_content:
      input:
        section: "A1_basic_info"
        content: "Package Name: test"
      expected: fail
      error_message: "Insufficient content length"

# Technical Accuracy Tests
test_technical_accuracy:
  command_verification:
    test_valid_commands:
      input:
        build_commands: |
          ./configure --prefix=/usr
          make
          make install
      expected: pass
    test_invalid_commands:
      input:
        build_commands: |
          ./invalid-configure
          make_wrong
      expected: fail
      error_message: "Invalid build commands"

  dependency_verification:
    test_valid_dependencies:
      input:
        dependencies:
          - "gcc >= 8.0.0"
          - "make >= 4.2"
      expected: pass
    test_invalid_dependencies:
      input:
        dependencies:
          - "nonexistent-package"
      expected: fail
      error_message: "Invalid dependency specified"

# Clarity and Style Tests
test_clarity_style:
  readability:
    test_good_readability:
      input: |
        This is a clear technical description
        with proper formatting and structure.
      expected:
        flesch_kincaid: 65
        technical_clarity: 0.85
    test_poor_readability:
      input: |
        vcry tchnical txt w/o proper struct.
      expected: fail
      error_message: "Poor readability score"

  formatting:
    test_valid_formatting:
      input: |
        # Header
        - List item 1
        - List item 2
        ```bash
        ./configure
        make
        ```
      expected: pass
    test_invalid_formatting:
      input: |
        #Invalid Header
        * Wrong list
        ```
        Unclosed code block
      expected: fail
      error_message: "Invalid markdown formatting"

# Cross-Reference Tests
test_cross_references:
  internal_links:
    test_valid_links:
      input:
        links:
          - "Section B8 -> gcc >= 8.0.0"
          - "Section D19 -> make install"
      expected: pass
    test_broken_links:
      input:
        links:
          - "Section X99 -> nonexistent"
      expected: fail
      error_message: "Broken internal links"

  version_references:
    test_valid_versions:
      input:
        references:
          - "gcc-8.0.0"
          - "make-4.2"
      expected: pass
    test_invalid_versions:
      input:
        references:
          - "gcc-invalid"
      expected: fail
      error_message: "Invalid version reference"

# Integration Tests
test_integration:
  full_review_pipeline:
    test_complete_review:
      input: "test_fixtures.yaml#basic_package"
      stages:
        - completeness
        - technical_accuracy
        - clarity_style
        - cross_references
      expected: pass
    test_failed_review:
      input: "test_fixtures.yaml#invalid_package"
      stages:
        - completeness
        - technical_accuracy
        - clarity_style
        - cross_references
      expected: fail
      error_messages:
        - "Incomplete documentation"
        - "Technical inaccuracies found"
        - "Poor readability"

