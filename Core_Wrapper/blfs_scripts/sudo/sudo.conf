#
# /etc/sudo.conf
# Sudo system configuration file
#
# Format:
#   Plugin plugin_name plugin_path plugin_options
#   Path program_name program_path
#   Set variable_name value
#   Debug program_name debug_flags
#

# Plugin configuration
# Core plugins - should not be disabled
Plugin sudoers_policy   sudoers.so
Plugin sudoers_io       sudoers.so
Plugin sudoers_audit    sudoers.so

# Optional plugins
#Plugin approval_plugin approval.so

# Set plugin options
Set disable_coredump true
Set maxseq 2176782336
Set ignore_dot true
Set ignore_unknown_defaults true

# Authentication service path
Path noexec     /usr/libexec/sudo/sudo_noexec.so
Path askpass    /usr/libexec/sudo/sudo_askpass
Path sesh       /usr/libexec/sudo/sesh

# Logging configuration
Debug sudo       /var/log/sudo_debug
Debug sudoers    /var/log/sudoers_debug

# I/O plugin configuration (log both input and output)
Set iolog_dir        /var/log/sudo-io
Set iolog_mode       0600
Set iolog_compress   true
Set iolog_flush      true
Set iolog_group      root

# Security settings
Set passprompt_regex    "^\\[sudo\\] password for"
Set log_allowed         true
Set log_denied         true
Set log_format         sudo
Set mailfrom           root
Set mailto             root
Set mail_if_no_user    true
Set mail_no_perms      true
Set mail_all_cmnds     false
Set mail_no_host       true
Set mail_no_user       true

# Path settings
Set secure_path        /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
Set editor_path        /usr/bin/editor:/usr/bin/vim:/usr/bin/vi
Set noexec_path       /usr/libexec/sudo
Set plugin_dir        /usr/lib/sudo

# Performance settings
Set max_groups        1024
Set timespec_timeout  180
Set command_timeout   300
Set probe_interfaces  true

# Locale settings
Set locale_messages   "C"
Set locale_time      "C"

